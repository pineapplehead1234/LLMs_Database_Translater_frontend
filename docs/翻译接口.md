 # API æ¥å£æ–‡æ¡£ï¼ˆMVPï¼‰

 ## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

 - **é¡¹ç›®åç§°**: ç¿»è¯‘åº”ç”¨ APIï¼ˆæœ€å°å¯è¡Œç‰ˆæœ¬ï¼‰
 - **ç‰ˆæœ¬**: 0.1.0-MVP
 - **Base URL**: `http://localhost:8000`
 - **Content-Type**: `multipart/form-data`
 - **ç¿»è¯‘æ–¹å‘é»˜è®¤**: è‹±æ–‡(en) â†’ ä¸­æ–‡(zh)
 - **è®¤è¯**: æ— éœ€ç™»å½•

 ---

 ## ğŸ“¤ å•æ–‡ä»¶æ–‡æ¡£ç¿»è¯‘æ¥å£ï¼ˆæ— çŸ¥è¯†åº“ï¼‰

 ### POST /api/document/upload

 - **åŠŸèƒ½æè¿°**: ä¸Šä¼ ä¸€ä¸ªè‹±æ–‡æ–‡æ¡£å¹¶ç¿»è¯‘ä¸ºä¸­æ–‡ï¼Œè¿”å›åŸæ–‡ Markdownã€è¯‘æ–‡ Markdown å’Œæœ¯è¯­æ ‡æ³¨ã€‚
 - **æ”¯æŒæ ¼å¼**: PDF, DOCX, Markdown (.md)
 - **è¯´æ˜**: æ­¤æ¥å£ä¸€æ¬¡ä»…å¤„ç†ä¸€ä¸ªæ–‡ä»¶ï¼›è¿”å›ç»“æ„æ²¿ç”¨æ‰¹é‡æ¥å£çš„æ ¼å¼ï¼Œä½† `results` ä»…æœ‰ 1 æ¡ï¼ˆä¾¿äºåç«¯/å‰ç«¯åç»­æ— ç¼æ‰©å±•åˆ°å¤šæ–‡ä»¶ï¼‰ã€‚

 ---

 ### è¯·æ±‚å‚æ•°ï¼ˆmultipart/form-dataï¼‰

 | å‚æ•°å | ç±»å‹ | æ˜¯å¦å¿…éœ€ | è¯´æ˜ |
 |--------|------|---------|------|
 | files | File | âœ… å¿…éœ€ | å•ä¸ªæ–‡ä»¶ï¼ˆpdf/docx/mdï¼‰ |
 | sourceLang | string | âŒ å¯é€‰ | æºè¯­è¨€ï¼Œé»˜è®¤ `en` |
 | targetLang | string | âŒ å¯é€‰ | ç›®æ ‡è¯­è¨€ï¼Œé»˜è®¤ `zh` |
 | clientRequestId | string | âŒ å¯é€‰ | å‰ç«¯ä¼ å…¥çš„å…³è”æ ‡è¯†ï¼ˆå»ºè®®ä½¿ç”¨â€œè§„èŒƒåŒ–æ–‡ä»¶å®Œæ•´è·¯å¾„â€ï¼‰ï¼Œåç«¯åŸæ ·å›ä¼  |

 - **clientRequestId å»ºè®®ï¼ˆå‰ç«¯ï¼‰**: å°†æ–‡ä»¶æ ‘ä¸­çš„â€œæ–‡ä»¶å®Œæ•´è·¯å¾„â€è§„èŒƒåŒ–ä¸ºï¼šç»Ÿä¸€ä½¿ç”¨ `/` åˆ†éš”ã€å»é‡æ–œæ ã€å»æ‰æœ«å°¾æ–œæ ã€‚ä¾‹å¦‚ï¼š`work/docs/doc1.pdf`

 ---

 ### è¯·æ±‚ç¤ºä¾‹

 - Axiosï¼ˆå‰ç«¯ï¼‰
 ```ts
 const formData = new FormData()
 formData.append('files', file)
 formData.append('sourceLang', 'en')
 formData.append('targetLang', 'zh')
 formData.append('clientRequestId', 'work/docs/doc1.pdf')

 axios.post('/api/document/upload', formData)
 ```

 - cURLï¼ˆè°ƒè¯•ï¼‰
 ```bash
 curl -X POST \
   -F "files=@./doc1.pdf" \
   -F "sourceLang=en" \
   -F "targetLang=zh" \
   -F "clientRequestId=work/docs/doc1.pdf" \
   http://localhost:8000/api/document/upload
 ```

 ---

 ### å“åº”æ ¼å¼ï¼ˆåŒæ­¥ï¼Œå•æ–‡ä»¶æˆåŠŸï¼‰

 ä¿æŒä¸æ‰¹é‡ç‰ˆæœ¬å…¼å®¹ï¼šé¡¶å±‚åŒ…å«ç»Ÿè®¡å­—æ®µï¼›`results` ä»… 1 æ¡ã€‚

 ```json
 {
   "success": true,
   "results": [
     {
       "fileId": "abc123",
       "filename": "doc1.pdf",
       "fileType": "pdf",
       "status": "success",
       "format": "markdown",
       "originalMarkdown": "# Title\n\nOriginal content...",
       "translatedMarkdown": "# æ ‡é¢˜\n\nè¯‘æ–‡å†…å®¹...",
       "termAnnotations": [],
       "clientRequestId": "work/docs/doc1.pdf"
     }
   ]
 }
 ```

 ### å“åº”æ ¼å¼ï¼ˆå¤±è´¥ç¤ºä¾‹ï¼‰

 - é¡¶å±‚å¤±è´¥ï¼ˆå…¨éƒ¨å¤±è´¥ï¼‰ï¼š
 ```json
 {
   "success": false,
   "results": [
     {
       "fileId": "temp-uuid",
       "filename": "doc1.pdf",
       "fileType": "pdf",
       "status": "error",
       "error": "æ–‡ä»¶è§£æå¤±è´¥æˆ–ä¸æ”¯æŒçš„æ ¼å¼",
       "clientRequestId": "work/docs/doc1.pdf"
     }
   ]
 }
 ```

 - ç»Ÿä¸€é”™è¯¯ç»“æ„ï¼ˆå»ºè®®åç«¯åœ¨ 4xx/5xx æ—¶è¿”å›ï¼‰ï¼š
 ```json
 { "success": false, "code": "FILE_TOO_LARGE", "message": "è¶…è¿‡å¤§å°é™åˆ¶" }
 ```

 ---

 ### å­—æ®µè¯´æ˜ï¼ˆä¸å‰ç«¯æ–‡ä»¶æ ‘å¯¹æ¥ï¼‰

 - **clientRequestId**: å‰ç«¯ç”¨äºå°†è¿”å›ç»“æœå›å¡«åˆ°æ–‡ä»¶æ ‘ä¸æœ¬åœ°å­˜å‚¨çš„å…³é”®æ ‡è¯†ï¼›åç«¯åº”åŸæ ·å›ä¼ ã€‚
 - **fileId**: åç«¯ç”Ÿæˆçš„æ–‡ä»¶å¤„ç† IDï¼›å‰ç«¯å¯ç”¨äºåç»­æº¯æºæˆ–è¯¦æƒ…æŸ¥çœ‹ã€‚
 - **format**: å›ºå®šä¸º `"markdown"`ã€‚
 - **termAnnotations**: æœ¯è¯­æ ‡æ³¨ï¼Œç»“æ„ä¸å†å²æ–‡æ¡£ä¸€è‡´ï¼š
 ```json
 {
   "term": "Machine Learning",
   "translation": "æœºå™¨å­¦ä¹ ",
   "position": { "start": 0, "end": 15 }
 }
 ```

 ---

 ### çº¦æŸä¸çº¦å®š

 - **æ–‡ä»¶ç±»å‹**: `pdf | docx | md`
 - **å•æ–‡ä»¶å¤§å°ä¸Šé™**: å»ºè®® 50MBï¼ˆè¯·åç«¯æ˜ç¡®å…·ä½“ä¸Šé™ï¼‰
 - **è¯­è¨€ä»£ç **: é»˜è®¤ä¸º `en` â†’ `zh`ï¼Œå¦‚éœ€å…¶ä»–è¯­è¨€è¯·æŒ‰ ISO-639-1 æä¾›ï¼ˆç¤ºä¾‹ï¼š`en`ã€`zh`ï¼‰
 - **å®‰å…¨**: Markdown å†…å®¹æœåŠ¡ç«¯å·²è¿›è¡Œ HTML è½¬ä¹‰ï¼Œå‰ç«¯ä»éœ€ä½¿ç”¨å…·å¤‡ XSS é˜²æŠ¤çš„ Markdown æ¸²æŸ“å™¨

 ---

 ## ğŸ”œ æœªæ¥æ‰©å±•ï¼ˆä¸å½±å“æœ¬ MVPï¼‰

 - å¤šæ–‡ä»¶ä¸Šä¼ ï¼šç»§ç»­æ²¿ç”¨åŒä¸€è·¯å¾„ä¸ç»“æ„ï¼Œ`results` å¯åŒ…å«å¤šæ¡
 - çŸ¥è¯†åº“ï¼šæ–°å¢å¯é€‰å­—æ®µ `knowledgeBase`ï¼ˆJSON å­—ç¬¦ä¸²ï¼‰ï¼Œæˆ–æ”¹ä¸º `knowledgeBaseId`
 - å¼‚æ­¥å¤„ç†ï¼šè¿”å› `202 Accepted` ä¸ `jobId`ï¼Œé€šè¿‡ `GET /api/translations/{jobId}` æŸ¥è¯¢çŠ¶æ€

 ---

 ## âœ… ä¸€å¥è¯å¯¹é½ï¼ˆå‘åç«¯ï¼‰

 â€œè¯·æä¾› `POST /api/document/upload`ï¼ˆmultipart/form-dataï¼‰ï¼Œå•æ–‡ä»¶å­—æ®µ `files`ï¼›å¯é€‰ `sourceLang`ã€`targetLang`ï¼Œä»¥åŠ `clientRequestId`ï¼ˆå‰ç«¯æ–‡ä»¶è·¯å¾„ IDï¼ŒåŸæ ·å›ä¼ ï¼‰ã€‚å“åº”æ²¿ç”¨æ‰¹é‡ç»“æ„ä½† `results` ä»… 1 æ¡ï¼ŒåŒ…å« `originalMarkdown`ã€`translatedMarkdown`ã€`termAnnotations` ä¸ `clientRequestId`ã€‚â€


